<!DOCTYPE html>
<html>
<head>
    <title>Minecraft JS: Celestial Update</title>
    <style>
        * { box-sizing: border-box; }
        body {
            background-color: #111;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            margin: 0; padding: 0;
            user-select: none;
            overflow: hidden;
        }

        /* --- START SCREEN --- */
        #start-screen {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 99999;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background-color: #2e211b;
            background-image: 
                linear-gradient(45deg, #3d2e26 25%, transparent 25%, transparent 75%, #3d2e26 75%, #3d2e26),
                linear-gradient(45deg, #3d2e26 25%, transparent 25%, transparent 75%, #3d2e26 75%, #3d2e26);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            box-shadow: inset 0 0 150px rgba(0,0,0,0.8);
        }

        .logo-container {
            position: relative;
            margin-bottom: 60px;
            animation: floatLogo 3s ease-in-out infinite;
        }

        h1 {
            font-family: 'Courier New', monospace;
            font-size: 60px; 
            color: #dcdcdc; 
            margin: 0;
            letter-spacing: -2px;
            text-shadow: 4px 4px 0 #3f3f3f, -1px -1px 0 #3f3f3f, 1px -1px 0 #3f3f3f, -1px 1px 0 #3f3f3f, 1px 1px 0 #3f3f3f;
            font-weight: 900;
        }

        .splash-text {
            position: absolute; bottom: -20px; right: -60px;
            color: #ffff55; font-size: 24px; font-weight: bold;
            transform: rotate(-20deg);
            text-shadow: 2px 2px 0 #3f3f3f;
            animation: pulseSplash 0.5s alternate infinite ease-in;
            white-space: nowrap;
        }

        #start-btn {
            position: relative; padding: 15px 80px; font-size: 24px;
            color: #fff; background-color: #7c7c7c; border: none;
            cursor: pointer; font-family: sans-serif;
            text-shadow: 2px 2px 0 #333;
            box-shadow: inset 2px 2px 0 #aaa, inset -2px -2px 0 #333, 2px 2px 0 #000;
            border: 2px solid #000; transition: background 0.1s;
        }
        #start-btn:hover { background-color: #8e8e8e; }
        #start-btn:active { background-color: #555; box-shadow: inset 2px 2px 0 #333, inset -2px -2px 0 #aaa; }

        @keyframes floatLogo { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        @keyframes pulseSplash { 0% { transform: rotate(-20deg) scale(1); } 100% { transform: rotate(-20deg) scale(1.1); } }

        /* --- PAUSE MENU --- */
        #pause-menu {
            display: none;
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px;
            background: #2c2c2c;
            border: 4px solid #fff;
            padding: 20px;
            z-index: 20000;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
        }

        .pause-btn {
            display: block; width: 100%; margin: 10px 0; padding: 10px;
            background: #555; color: white; border: 2px solid #111;
            cursor: pointer; font-family: monospace; font-size: 16px;
        }
        .pause-btn:hover { background: #666; border-color: #fff; }

        /* --- VIEWPORT & WORLD --- */
        #viewport {
            position: relative; width: 850px; height: 600px; margin: 20px auto;
            background-color: #87CEEB; border: 6px solid #333; overflow: hidden;
            display: none; z-index: 1;
        }
        #sun { position: absolute; width: 60px; height: 60px; background: #ffeb3b; border-radius: 50%; box-shadow: 0 0 40px #fff176; z-index: 1; }
        #moon { position: absolute; width: 50px; height: 50px; background: #eceff1; border-radius: 50%; box-shadow: 0 0 20px #fff; z-index: 1; }
        .cloud { position: absolute; background: white; border-radius: 10px; opacity: 0.8; z-index: 2; }
        #world { position: absolute; top: 0; left: 0; will-change: transform; z-index: 10; transform-origin: 0 0; }
        .block { position: absolute; width: 25px; height: 25px; }

        /* --- PLAYER & FX --- */
        .shaking { animation: shake 0.1s linear infinite; }
        @keyframes shake { 0% { transform: translate(0, 0); } 25% { transform: translate(-2px, 1px); } 50% { transform: translate(2px, -1px); } 75% { transform: translate(-2px, -1px); } 100% { transform: translate(0, 0); } }
        
        .particle { position: absolute; width: 8px; height: 8px; z-index: 15; pointer-events: none; opacity: 1; transition: transform 0.4s ease-out, opacity 0.4s ease-in; }

        /* Textures */
        .grass { background: #4caf50; border-top: 4px solid #8bc34a; }
        .dirt { background: #795548; }
        .stone { background: #757575; border: 1px solid #616161; }
        .sand { background: #f4e1a1; border-top: 2px solid #e6cc80; }
        .sandstone { background: #d3b36b; border: 1px solid #c2a25a; }
        .wood { background: #5d4037; border: 2px solid #3e2723; }
        .leaves { background: #2e7d32; opacity: 0.9; }
        .cactus { background: #1b5e20; border-left: 4px dotted #4caf50; border-right: 4px dotted #4caf50; }
        .coal { background: #424242; }
        .iron { background: #d7ccc8; }
        .gold { background: #ffd700; }
        .diamond { background: #00e5ff; }
        .sky { background: transparent; }

        #player { position: absolute; width: 22px; height: 44px; z-index: 100; transform-origin: bottom center; transition: transform 0.1s steps(3); }
        #p-head { width: 22px; height: 22px; background: #ffdbac; border: 2px solid #000; }
        #p-body { width: 18px; height: 22px; background: #0288d1; border: 2px solid #000; margin-left: 2px; border-top: none; }
        
        #tool { position: absolute; top: 18px; right: -8px; transform-origin: left; transform: rotate(-40deg); transition: background 0.1s; }
        .swing { animation: swing 0.15s ease-in-out; }
        @keyframes swing { 0% { transform: rotate(-40deg); } 50% { transform: rotate(50deg); } 100% { transform: rotate(-40deg); } }

        #selector { position: absolute; width: 25px; height: 25px; border: 2px solid #fff; z-index: 90; pointer-events: none; }

        /* --- UI ELEMENTS --- */
        #inv-screen { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 550px; background: #2c2c2c; border: 4px solid #fff; padding: 20px; z-index: 5000; }
        .inv-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; }
        .slot { background: #444; padding: 5px; border: 2px solid #111; cursor: pointer; text-align: center; }
        .slot.active { border-color: #ffee58; background: #555; }

        #hotbar { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); display: flex; gap: 4px; background: rgba(30, 30, 30, 0.9); padding: 6px; border: 3px solid #fff; border-radius: 6px; z-index: 10000; box-shadow: 0 0 10px rgba(0,0,0,0.8); }
        .hot-slot { width: 36px; height: 36px; background: #555; border: 2px solid #222; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; }
        .hot-slot.active { border-color: #ffee58; background: #777; box-shadow: inset 0 0 0 1px #fff; transform: scale(1.05); }
        .hot-key { position: absolute; top: 1px; left: 2px; font-size: 8px; color: #fff; font-family: monospace; z-index: 2; }
        .hot-amount { position: absolute; bottom: 0; right: 2px; font-size: 10px; font-weight: bold; color: white; text-shadow: 1px 1px 0 #000; z-index: 2; }

        #debug { position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.7); padding: 8px; font-size: 12px; z-index: 6000; }
    </style>
</head>
<body>

    <div id="start-screen">
        <div class="logo-container">
            <h1>MINECRAFT<br>CELESTIAL</h1>
            <div class="splash-text">Now with Wobble!</div>
        </div>
        <button id="start-btn">Start Game</button>
    </div>

    <div id="pause-menu">
        <h2 style="margin-top:0;">GAME PAUSED</h2>
        <button class="pause-btn" id="resume-btn">Continue Game</button>
        <button class="pause-btn" id="exit-btn">Exit to Menu</button>
    </div>

    <div id="debug">Waiting for start...</div>
    <div id="hotbar"></div>

    <div id="viewport">
        <div id="sun"></div>
        <div id="moon"></div>
        <div id="world">
            <div id="player"><div id="p-head"></div><div id="p-body"></div><div id="tool"></div></div>
            <div id="selector"></div>
        </div>
    </div>

    <div id="inv-screen">
        <h2 style="margin-top:0;">INVENTORY</h2>
        <div class="inv-grid" id="inv-grid"></div>
        <button id="close-inv-btn" style="margin-top:20px; width:100%; padding: 10px; cursor:pointer;">CLOSE (E)</button>
    </div>

    <script>
        // --- CONFIGURATION ---
        const B_SIZE = 25;
        const COLS = 300; 
        const ROWS = 50; 
        const ZOOM = 1.6; 

        const TYPES = { SKY:0, GRASS:1, DIRT:2, STONE:3, COAL:4, IRON:5, GOLD:6, DIAMOND:7, EMERALD:8, SAND:9, SANDSTONE:10, WOOD:11, LEAVES:12, CACTUS:13 };
        const CLASSES = ["sky", "grass", "dirt", "stone", "coal", "iron", "gold", "diamond", "emerald", "sand", "sandstone", "wood", "leaves", "cactus"];
        
        let inventory = {};
        for(let i=1; i<CLASSES.length; i++) inventory[i] = 0;
        
        let equipped = 1;
        let invOpen = false;
        let isPaused = false; // New Pause State
        let mapData = [];
        let blockDivs = [];
        let px = 20, py = 5; 
        let vx = 0, vy = 0, grounded = false;
        let keys = {};
        let gameTime = 0;
        const clouds = [];
        let walkCycle = 0;
        let facingDir = 1; 
        let isBreaking = false; 

        // --- DOM ELEMENTS ---
        const world = document.getElementById('world');
        const viewport = document.getElementById('viewport');
        const player = document.getElementById('player');
        const tool = document.getElementById('tool');
        const debug = document.getElementById('debug');
        const sun = document.getElementById('sun');
        const moon = document.getElementById('moon');
        const startBtn = document.getElementById('start-btn');
        const invScreen = document.getElementById('inv-screen');
        const closeInvBtn = document.getElementById('close-inv-btn');
        
        // Pause Menu Elements
        const pauseMenu = document.getElementById('pause-menu');
        const resumeBtn = document.getElementById('resume-btn');
        const exitBtn = document.getElementById('exit-btn');

        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', () => {
            document.getElementById('start-screen').style.display = 'none';
            viewport.style.display = 'block';
            document.getElementById('hotbar').style.display = 'flex';
            initWorld();
            initClouds();
            updateHandAppearance();
            requestAnimationFrame(gameLoop);
        });

        closeInvBtn.addEventListener('click', toggleInv);

        // Pause Menu Buttons
        resumeBtn.addEventListener('click', togglePause);
        exitBtn.addEventListener('click', () => {
            location.reload(); // Simple refresh to go back to menu
        });

        function toggleInv() {
            if (isPaused) return; // Cannot open inv while paused
            invOpen = !invOpen;
            invScreen.style.display = invOpen ? 'block' : 'none';
        }

        function togglePause() {
            isPaused = !isPaused;
            pauseMenu.style.display = isPaused ? 'block' : 'none';
        }

        function setEquipped(id) {
            equipped = id;
            updateInvUI();
            updateHandAppearance();
        }

        // --- WORLD GENERATION ---
        function initClouds() {
            for(let i=0; i<8; i++) {
                let cloud = {
                    x: Math.random() * 800,
                    y: 20 + Math.random() * 150,
                    w: 60 + Math.random() * 100,
                    h: 20 + Math.random() * 30,
                    speed: 0.1 + Math.random() * 0.3,
                    el: document.createElement('div')
                };
                cloud.el.className = 'cloud';
                cloud.el.style.width = cloud.w + 'px';
                cloud.el.style.height = cloud.h + 'px';
                viewport.appendChild(cloud.el);
                clouds.push(cloud);
            }
        }

        function createBlock(r, c, type) {
            if (type === TYPES.SKY) return;
            const div = document.createElement('div');
            div.className = 'block ' + CLASSES[type];
            div.style.left = (c * B_SIZE) + "px";
            div.style.top = (r * B_SIZE) + "px";
            world.appendChild(div);
            mapData[r][c] = type;
            blockDivs[r][c] = div;
        }

        function createParticles(r, c, type) {
            for(let i=0; i<4; i++) {
                const p = document.createElement('div');
                p.className = 'particle ' + CLASSES[type];
                let offsetX = (Math.random() * 15) + 5; 
                let offsetY = (Math.random() * 15) + 5;
                p.style.left = ((c * B_SIZE) + offsetX) + "px";
                p.style.top = ((r * B_SIZE) + offsetY) + "px";
                p.style.borderRadius = (Math.random() * 5) + "px";
                world.appendChild(p);

                requestAnimationFrame(() => {
                    let tx = (Math.random() - 0.5) * 60; 
                    let ty = (Math.random() - 0.5) * 60; 
                    let rot = (Math.random() - 0.5) * 360; 
                    p.style.transform = `translate(${tx}px, ${ty}px) rotate(${rot}deg) scale(0)`;
                    p.style.opacity = "0";
                });
                setTimeout(() => p.remove(), 400);
            }
        }

        function initWorld() {
            world.style.width = (COLS * B_SIZE) + "px";
            world.style.height = (ROWS * B_SIZE) + "px";
            let currentHeight = 25; 
            let heights = [];

            for (let c = 0; c < COLS; c++) {
                let biome = c < 80 ? "plains" : (c < 180 ? "mountains" : "desert");
                if (biome === "plains") {
                    if (Math.random() < 0.2) currentHeight += (Math.random() > 0.5 ? 1 : -1);
                    currentHeight = Math.max(22, Math.min(28, currentHeight));
                } else if (biome === "mountains") {
                    if (Math.random() < 0.7) currentHeight += (Math.random() > 0.4 ? -1 : 1);
                    currentHeight = Math.max(5, Math.min(25, currentHeight));
                } else if (biome === "desert") {
                    if (Math.random() < 0.3) currentHeight += (Math.random() > 0.5 ? 1 : -1);
                    currentHeight = Math.max(20, Math.min(26, currentHeight));
                }
                heights[c] = Math.floor(currentHeight);
            }

            for (let r = 0; r < ROWS; r++) {
                mapData[r] = []; blockDivs[r] = [];
                for (let c = 0; c < COLS; c++) { mapData[r][c] = TYPES.SKY; blockDivs[r][c] = null; }
            }

            for (let c = 0; c < COLS; c++) {
                let ground = heights[c];
                let biome = c < 80 ? "plains" : (c < 180 ? "mountains" : "desert");
                if(c === 20) py = ground - 3; 

                for (let r = ground; r < ROWS; r++) {
                    let type = TYPES.STONE;
                    if (r === ground) type = (biome === "desert") ? TYPES.SAND : (biome === "mountains" ? TYPES.STONE : TYPES.GRASS);
                    else if (r < ground + 4) type = (biome === "desert") ? TYPES.SANDSTONE : (biome === "mountains" ? TYPES.STONE : TYPES.DIRT);
                    else if (Math.random() < 0.05) type = TYPES.COAL;
                    createBlock(r, c, type);
                }

                if (biome === "plains" && Math.random() < 0.1 && c > 5) {
                    let h = 3 + Math.floor(Math.random() * 2);
                    for (let i = 1; i <= h; i++) createBlock(ground - i, c, TYPES.WOOD);
                    for (let x = -1; x <= 1; x++) for (let y = -2; y <= 0; y++) createBlock(ground - h + y, c + x, TYPES.LEAVES);
                } else if (biome === "desert" && Math.random() < 0.08 && c > 185) {
                    let h = 2 + Math.floor(Math.random() * 2);
                    for (let i = 1; i <= h; i++) createBlock(ground - i, c, TYPES.CACTUS);
                }
            }
            updateInvUI();
        }

        function updateInvUI() {
            const grid = document.getElementById('inv-grid');
            const hotbar = document.getElementById('hotbar');
            
            if (!hotbar) return;

            grid.innerHTML = '';
            hotbar.innerHTML = '';
            
            let ownedItems = [];
            for (let i = 1; i < CLASSES.length; i++) {
                if (inventory[i] > 0) {
                    ownedItems.push(i);
                    const slot = document.createElement('div');
                    slot.className = `slot ${equipped === i ? 'active' : ''}`;
                    slot.innerHTML = `<div class="block ${CLASSES[i]}" style="position:static; display:inline-block;"></div><div style="font-size:10px;">x${inventory[i]}</div>`;
                    slot.onclick = () => setEquipped(i);
                    grid.appendChild(slot);
                }
            }

            for (let i = 0; i < 9; i++) {
                const hSlot = document.createElement('div');
                const itemType = ownedItems[i];
                const isActive = (itemType && equipped === itemType);
                
                hSlot.className = `hot-slot ${isActive ? 'active' : ''}`;
                
                const keyNum = document.createElement('div');
                keyNum.className = 'hot-key';
                keyNum.innerText = (i + 1);
                hSlot.appendChild(keyNum);

                if (itemType) {
                    const icon = document.createElement('div');
                    icon.className = `block ${CLASSES[itemType]}`;
                    icon.style.position = 'static';
                    icon.style.transform = 'scale(0.85)';
                    hSlot.appendChild(icon);
                    
                    const amt = document.createElement('div');
                    amt.className = 'hot-amount';
                    amt.innerText = inventory[itemType];
                    hSlot.appendChild(amt);
                    hSlot.onclick = () => setEquipped(itemType);
                } else {
                    hSlot.style.opacity = "0.4";
                }
                
                hotbar.appendChild(hSlot);
            }
            if (grid.innerHTML === '') grid.innerHTML = '<div style="color:#888;">Inventory Empty</div>';
        }

        function updateHandAppearance() {
            tool.className = '';
            if (inventory[equipped] > 0) {
                tool.classList.add(CLASSES[equipped]);
                tool.style.width = '12px'; tool.style.height = '12px';
                tool.style.background = '';
                tool.style.border = '1px solid rgba(0,0,0,0.3)';
            } else {
                tool.style.background = '#5d4037';
                tool.style.width = '18px'; tool.style.height = '6px';
                tool.style.border = 'none';
            }
        }

        // --- CONTROLS ---
        window.addEventListener('keydown', e => {
            const key = e.key.toLowerCase();
            keys[key] = true;
            
            // KEYBOARD SHORTCUTS LOGIC
            if (key === 'escape') {
                if (invOpen) {
                    toggleInv(); // Close inventory if open
                } else {
                    togglePause(); // Otherwise toggle pause
                }
            } else if (key === 'e' && !isPaused) {
                toggleInv();
            }
            
            if (e.key >= '1' && e.key <= '9') {
                const owned = [];
                for(let i=1; i<CLASSES.length; i++) if(inventory[i] > 0) owned.push(i);
                const idx = parseInt(e.key) - 1;
                if(owned[idx] !== undefined) setEquipped(owned[idx]);
            }
        });

        window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

        viewport.addEventListener('mousedown', e => {
            if (invOpen || isPaused || isBreaking) return; 

            tool.classList.add('swing');
            setTimeout(() => tool.classList.remove('swing'), 150);

            const rect = world.getBoundingClientRect();
            const mx = Math.floor(((e.clientX - rect.left) / ZOOM) / B_SIZE);
            const my = Math.floor(((e.clientY - rect.top) / ZOOM) / B_SIZE);

            if (mx < 0 || mx >= COLS || my < 0 || my >= ROWS) return;
            const dist = Math.sqrt(Math.pow(mx - px, 2) + Math.pow(my - py, 2));
            if (dist > 6) return;

            if (e.shiftKey) {
                if (mapData[my][mx] === TYPES.SKY && inventory[equipped] > 0) {
                    createBlock(my, mx, equipped);
                    inventory[equipped]--;
                    updateInvUI();
                    updateHandAppearance();
                }
            } else {
                if (mapData[my][mx] !== TYPES.SKY) {
                    const targetBlock = blockDivs[my][mx];
                    if(targetBlock) {
                        isBreaking = true;
                        targetBlock.classList.add('shaking');
                        setTimeout(() => {
                            inventory[mapData[my][mx]]++;
                            createParticles(my, mx, mapData[my][mx]);
                            targetBlock.remove();
                            mapData[my][mx] = TYPES.SKY;
                            updateInvUI();
                            updateHandAppearance();
                            isBreaking = false;
                        }, 300);
                    }
                }
            }
        });

        // --- GAME LOOP ---
        function gameLoop() {
            // PAUSE CHECK: Do not run logic if paused or inventory is open
            if (!invOpen && !isPaused) {
                gameTime += 0.002;
                let dayFactor = Math.sin(gameTime);
                let sunX = (Math.cos(gameTime) * 400) + 400;
                let sunY = (Math.sin(gameTime) * 250) + 300;
                let moonX = (Math.cos(gameTime + Math.PI) * 400) + 400;
                let moonY = (Math.sin(gameTime + Math.PI) * 250) + 300;

                sun.style.left = sunX + 'px'; sun.style.top = sunY + 'px';
                moon.style.left = moonX + 'px'; moon.style.top = moonY + 'px';

                let skyR = Math.max(20, 135 * dayFactor + 20);
                let skyG = Math.max(20, 206 * dayFactor + 20);
                let skyB = Math.max(40, 235 * dayFactor + 40);
                viewport.style.backgroundColor = `rgb(${skyR}, ${skyG}, ${skyB})`;

                clouds.forEach(c => {
                    c.x += c.speed;
                    if(c.x > 850) c.x = -c.w;
                    c.el.style.left = c.x + 'px';
                    c.el.style.top = c.y + 'px';
                });

                // MOVEMENT
                const currentSpeed = keys['shift'] ? 0.28 : 0.15;
                vx = 0;
                if (keys['a'] || keys['arrowleft']) vx = -currentSpeed;
                if (keys['d'] || keys['arrowright']) vx = currentSpeed;

                // COLLISIONS
                let actualMoveX = 0;
                if (!isSolid(px + vx, py + 0.1) && !isSolid(px + vx, py + 1.7)) {
                    px += vx;
                    actualMoveX = vx; 
                }

                // ANIMATION
                let wobbleRot = 0;
                if (vx !== 0 && Math.abs(actualMoveX) > 0.001) {
                    facingDir = vx > 0 ? 1 : -1;
                    if (grounded) {
                        walkCycle += 0.15; 
                        let rawSine = Math.sin(walkCycle);
                        if (rawSine > 0.4) wobbleRot = 12; 
                        else if (rawSine < -0.4) wobbleRot = -12;
                        else wobbleRot = 0;
                    } else {
                        walkCycle = 0;
                    }
                } else {
                    walkCycle = 0;
                    if(vx !== 0) facingDir = vx > 0 ? 1 : -1; 
                }

                player.style.transform = `scaleX(${facingDir}) rotate(${wobbleRot}deg)`;

                // PHYSICS
                vy += 0.04; 
                if ((keys['w'] || keys[' '] || keys['arrowup']) && grounded) { vy = -0.55; grounded = false; }
                if (isSolid(px, py + vy + 1.8) || isSolid(px, py + vy + 0.1)) {
                    if (vy > 0) grounded = true;
                    vy = 0;
                } else { py += vy; grounded = false; }

                player.style.left = (px * B_SIZE) + "px";
                player.style.top = (py * B_SIZE) + "px";

                const camX = -(px * B_SIZE * ZOOM) + 425;
                const camY = -(py * B_SIZE * ZOOM) + 300;
                
                const limitX = -(COLS * B_SIZE * ZOOM - 850);
                const limitY = -(ROWS * B_SIZE * ZOOM - 600);
                
                world.style.transform = `translate(${Math.min(0, Math.max(camX, limitX))}px, ${Math.min(0, Math.max(camY, limitY))}px) scale(${ZOOM})`;
                
                debug.innerText = `Time: ${dayFactor > 0 ? 'Day' : 'Night'} | Biome: ${px < 80 ? 'Plains' : (px < 180 ? 'Mountains' : 'Desert')}`;
            }
            requestAnimationFrame(gameLoop);
        }

        function isSolid(x, y) {
            const r = Math.floor(y), c = Math.round(x);
            if(r < 0 || r >= ROWS || c < 0 || c >= COLS) return false;
            return (mapData[r][c] !== TYPES.SKY);
        }
    </script>
</body>
</html>
